# 多线程

## 线程概念的引入

- 早期进程数量通常超过CPU核数
  - 通过简单的分配和进程调度，即可让每个核得到一个进程

### 轻量级进程

- 共享页表的进程

### 线程

#### 包含的内容

- 独立的上下文
  - 实现跨核支持
- 独立的栈结构
  - 常规栈操作不互相影响
  - 函数调用返回等
- 共享代码和数据部分
- 共享的堆
  - 可以共享动态分配的内存

#### 进程与线程

- 相似
  - 都可以与其他进程/线程并发执行（可能在不同核心上）
  - 都可以进行上下文切换
    - 在引入线程之后，调度单位由进程变为线程
    - 线程才拥有独立的上下文
- 不同
  - 线程比进程开销更低
    - 同一进程的不同线程共享代码和数据
