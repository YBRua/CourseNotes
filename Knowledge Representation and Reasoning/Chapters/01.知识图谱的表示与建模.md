# 知识图谱的表示与建模

## 知识表示

- 用易于计算机处理的方式来描述人脑的知识
- **数据** 和 **知识** 的区别在于后者支持推理

## 知识图谱的经典表示方法

### 逻辑

> 命题逻辑、一阶逻辑、二阶逻辑

#### 优势与缺陷

- 优势
  - 自然、精确、严密、易于实现
- 缺陷
  - 无法表示不确定性的知识
  - 推理效率低
    - 事实、规则的组合爆炸

### 产生式规则表示 Production Rule

- 更广泛意义的规则系统
- 早期专家系统多数基于产生式系统

```txt
if P then Q  CF = [0, 1]
```

- `P` 是产生式的前提
- `Q` 是一组结论或操作
- `CF` 是置信度

#### 缺陷

- 效率较低
  - “不要在程序里写大段的 if if if if”
- 不能表达结构性知识

### 框架系统

- 基本思想
  - 认为人们对现实世界中事物的认识都是一种类似于框架的结构存储在记忆中
  - 在面临一个新事物时，会从记忆中找出一个合适的框架，根据实际情况对其细节进行修改补充，从而形成对当前事物的认识
- 在NLP对话系统中有一些应用
- 层次化的槽值对

```xml
<frame>
  <slot>
    <侧面> <!--这玩意儿英语是啥啊-->
      <value></value>
      <value></value>
      <value></value>
    </侧面>
    <侧面>
      <value></value>
      <value></value>
    </侧面>
  </slot>
  <constraints>
    <cstr></cstr>
    <cstr></cstr>
  </contraints>
</frame>
```

#### 优势与缺陷

- 优势
  - 完整、全面
  - 质量高
  - 允许数值计算
- 缺陷
  - 构建成本非常高，对知识库要求高
  - 难以与其他系统结合使用

### 语义网络 Semantic Network

- 认为人类的记忆是由概念之间的联系实现的

#### 基本形式

- 节点
  - 对象
- 弧
  - 节点之间的关系

#### 优势与缺陷

- 优势
  - 结构化的图结构
  - 支持联想推理
  - 自然
- 缺陷
  - 非严格性，缺乏严格的定义

## 知识图谱的符号表示方法

### Resource Description Framework RDF

- 描述资源概念模型的语言

```mermaid
graph LR
    Subject -->|Predicate|Object
```

- 表示为 `(Subject, Predicate, Object)` 的三元组，该三元组表示一个逻辑命题

#### Probase

- 微软构建的带概率的概念知识图谱
- 边只描述 `is(A)` 关系，但是带有概率

## 知识图谱的向量化表示方法

- 基于离散符号的知识表示
  - 显示知识、强逻辑约束、易于解释、推理不易扩展
- 基于连续向量的知识表示
  - 隐式知识、弱逻辑约束、不易解释、对接神经网络

### 分布式词向量与知识图谱嵌入

- 两个分布式词向量的差蕴含了两个词之间的“关系”

### 知识图谱嵌入

- 为每个实体和关系都学习一个向量表示
- 将离散的符号表示转换为连续的向量表示

#### TransE模型

- 对每个三元组 $(h, r, t)$

$$ h + r = t $$

我们希望 $h + r$ 尽可能接近 $t$

$$ f_r(h,t) = \|h+r-t\|_{L} $$

- 可以是 $L_1$、$L_2$ 范数

直觉上，只需要优化所有关系的误差的求和

- 可是这样不行。因为直接优化的结果可能是所有 $h,r,t$ 都是 $0$

##### 负样本

$$ L = \sum_{(h, r, t) \in S} \sum_{(h',r,t') \in S'} \max\left( 0, f_r(h,t) + \gamma - f_r(h',t') \right) $$

- 人为构造负样本
  - 替换 $h$ 或 $t$
    - 使用同类词替换
    - 不能随机构造，否则负样本的区分性太差
- 尽可能让正确的关系距离小、错误的关系距离大
- $\gamma$ 是 Margin，用于拉开正样本、负样本，利于模型优化

#### DistMult

- TransE 的建模中，头实体 $h$ 经过平移 $r$ 之后可以接近尾实体 $t$
- DistMult 的建模中，头实体 $h$ 经过线性变换 $M_r$ 之后接近尾实体 $t$

$$ hM_r = t $$

##### 目标函数

$$ f_r(h, t) = hM_rt $$

- 优化方式类似 TransE

### 知识图谱的预测问题

- 给定三元组中的某两个，预测另一个

以预测尾实体为例

- 枚举尾实体并和给定的 $h,r$ 计算距离，选择距离最小的尾实体

#### 评价标准

##### Mean Rank MR

##### Mean Reciprocal Rank MRR

- 先对所有预测样本的排名求倒数，然后求平均

##### Hit@n

- 所有预测样本中排名在前 $n$ 的比例
  - 常用的 $n$ 为 1，3，10 等
