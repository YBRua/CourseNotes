# 混合策略纳什均衡

## 混合策略

- 纯策略
  - 参与人在给定信息下只选择一种特定策略
- 混合策略
  - 参与人给定信息下以某种概率分布随机地选择行动，可以定义为策略空间上的概率分布

### 定义

博弈 $G$，对任意参与人 $i$，设 $S_i = \{s_1,\dots,s_K\}$。则参与人 $i$ 的一个混合策略定义为 $S_i$ 上的一个概率分布 $\sigma_i$

$$ \sigma_i^j \in [0, 1] \quad \sum_{k=1}^K \sigma_i^k = 1 $$

### 混合策略空间与混合策略组合空间

- $\Sigma_i$ 表示混合策略空间
- $\sigma = (\sigma_1,\dots,\sigma_n)$ 表示某个混合策略组合
- $\Sigma = \prod_i \Sigma_i$ 表示混合策略组合空间
  - 有 $\sigma \in \Sigma$

### 混合策略的收益

令 $u_i(s)$ 表示纯策略的收益，$v_i(\sigma)$ 表示混合策略的期望收益

$$ v_i(\sigma) = \sum_{s\in S} \left( \prod_{j=1}\sigma_i(s_j) \right) u_i(s) $$

- $\sigma_i(s_j)$ 是参与人 $i$ 选择纯策略组合 $s=(s_1,\dots,s_n)$ 中 $s_j$ 的概率

## 混合策略纳什均衡

在博弈 $G$ 中，混合策略组合 $\sigma^\ast$ 为一个 **纳什均衡** 当且仅当

$$ \forall i \in \Gamma, \forall \sigma_i \in \Sigma_i \quad v_i(\sigma_i^\ast,\sigma_{-i}^\ast) \ge v_i(\sigma_i, \sigma_{-i}^\ast) $$

- 在参与人可以选择混合策略的情况下，即使不存在相对某个纯策略 $s_i$ 占优的纯策略，$s_i$ 也可能成为劣策略

### 支撑 Support

对于给定的混合策略组合 $\sigma$，其支撑 $S(\sigma)$ 指参与人按照 $\sigma$ 选择策略时，纯策略组合集 $S$ 中以大于零的概率出现的所有纯策略组合的集合

$$ S(\sigma) = \prod_{i\in\Gamma}\{ s_i\in S_i | \sigma_i(s_i) > 0 \} $$

- 混合策略组合 $\sigma$ 的支撑是参与人按照 $\sigma$ 选择策略时，所有参与人支撑集的直积

### 最佳应对引理

#### 最佳应对

对于参与人2的策略 $T$，若参与人1的某个策略 $S$ 产生的收益大于或等于参与人1的任何策略，则 $S$ 是参与人2的策略 $T$ 的一个 **最佳应对**

#### 最佳应对引理

在有限静态博弈 $G$ 中，混合策略组合 $\sigma^\ast$ 是一个纳什均衡 当且仅当 $\forall i \in \Gamma$，$\sigma_i^\ast$ 的支撑集 $S_i(\sigma_i^\ast)$ 中每一个纯策略都是给定 $\sigma_{-i}^\ast$ 下的最佳应对。

#### 等值法

根据最佳应对引理中对最佳应对的约束，构建等式求解。常用于求解两个或少数个参与人的静态博弈。但是人多的时候求解比较复杂。

## 混合策略纳什均衡的求解

### 支撑求解法

#### 基本思路

1. 构造所有混合策略均衡的支撑
2. 对每个给定的支撑，根据最佳应对引理和概率和为1的约束，构造等式并求解

#### 步骤

对于给定的有限静态博弈 $G$，假设混合策略组合 $\sigma^\ast$ 为纳什均衡。

考察 $\sigma^\ast$ 的所有可能的支撑

- $\forall i \in \Gamma$，设 $\sigma_i^\ast = (\sigma_i^*(s_i^1),\dots,\sigma_i^*(s_i^K))$
- 不失一般性，设 $\sigma_i^*(s_i^k) > 0 \forall k$

根据最佳应对引理列写等式，并要求概率求和为1

#### 缺点

对于构造出来的支撑，需要对可能存在的支撑进行猜测，通常使用枚举法罗列所有可能的策略组合，但是会有以下问题

- 方程组的解不存在。原因在于构造的支撑有问题，需要重新构造支撑
- 解不满足非负性条件。部分解可能小于零
- 解存在且非负，但是与纳什均衡矛盾。支撑策略期望收益小于非支撑策略期望
- 繁琐

### 规划求解法

> 相对于支撑求解法，规划求解对双人有限静态博弈的求解尤为有效

考虑两人有限静态博弈，参与人1和2的策略集合分别为

- $S_1 = \{ s_1^1,\dots,s_1^n \}$
- $S_2 = \{ s_2^1,\dots,s_2^m \}$

用矩阵 $U_1 = (a_{ij})_{m \times n}$ 表示参与人1的收益，$U_2 = (b_{ij})_{m\times n}$ 表示参与人2的收益。

- $a_{ij}$ 表示参与人在 $(s_1^i,s_2^j)$ 下的期望收益

给定策略组合 $\sigma = (\sigma_1, \sigma_2)$

$$
\begin{aligned}
    \max \quad & z = \sigma_1 U_1 \sigma_2^T - \mu_1 + \sigma_1 U_2 \sigma_2^T - \mu_2\\
    \mathrm{s.t.} \quad & U_1\sigma_2^T
\end{aligned}
$$