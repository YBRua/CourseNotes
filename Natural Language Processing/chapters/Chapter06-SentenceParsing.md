# 句法分析

## 构成式语法

### 语法

#### 语法成分

- $N$
- 句子中的一组词，作为整体当作一个单独的语法单元
- 语法树的中间节点

#### 语法规则

- 描述某个语法成分可以由什么组成的规则

#### 词典

- $\Sigma$
  - 语法树的叶子节点
- 描述某个语法成为分可以由什么词来构成的规则
- 语法规则和词典用 $R$ 表示
  - 描述语法树的一个节点如何进一步分裂

### 生成句子

- 给定语法成分、语法规则和词典，即可由根节点 S 出发生成语句
- 能够由某一语法生成的语句，称为合乎语法的，否则是不合语法的

### 上下文相关与上下文无关语法

#### 上下文相关语法 Context-Sensitive Grammar CSG

- 语法树的生成与上下文相关
- 语法规则中左边不是单个的元素
  - `VP NP -> VP Nominal`

#### 上下文无关语法 Context-Free Grammar CFG

- 语法树的生产与上下文无关
- 每条语法规则中，左边均为单个元素
  - `S -> VP NP`

### 构建语法

> 怎么获得语法规则？
> 从语言学家标注的语料集中统计

#### 语料集

- Penn Treebank

#### 学习语法

- 从整个语料集中可以收集到17500+个语法规则
  - 不包括词典部分
- 似乎有点多

### 词汇化语法与组合范畴语法

#### 词汇化语法 Lexicalized Grammar

更多依赖具体词汇，认为合法的语法结构与词汇具体是什么相关

#### 组合范畴语法 Combinaroty Categorial Grammar CCG

##### 类别

- 基础类别
  - `S`, `Proper-Noun`, `Verb`, `NP`, `VP`, ...
- 由基础类别构成的函数以及函数的函数
  - `PP/NP`：在该词的右边放上 `NP`，则该词与其右边的成分共同构成一个 `PP`
  - `S\Pronoun`：在该词的左边放上一个 `Pronoun` （代词），则该词与其左边的成分可以共同构成一个句子 `S`
  - `(S\NP)/NP`：该词左、右分别放上一个 `NP`，可以构成一句句子 `S`

###### 例子

```text
 to     you
PP/NP   NP
-----------
    PP
```

##### 组合规则

- 前向匹配与后向匹配
  - `X/Y Y -> X`
  - `Y X\Y -> X`
- 并联
  - `X CONJ X -> X`
- 前向串联与后向串联
  - `X/Y Y/Z -> X/Z`
  - `Y\Z X\Y -> X\Z`
- 类别升迁
  - 将普通规则升迁到函数
  - `X => T/(T\X)`
  - `X => T\(T/X)`

### 乔姆斯基范式 CNF

#### 语法等价关系

- 强等价
  - 两个语法能生成一样的句子集合，且对于同一个句子，语法结构也相同
- 弱等价
  - 两个语法能生成一样的句子集合，但是同一个句子的语法结构不一定相同

#### 乔姆斯基范式 Chomsky Normal Form

- 在CFG的基础上，进一步要求
  - 每条语法规则只能从一个元素生成两个元素，且不能包含单词
  - 每条词典规则只能从一个元素生成一个单词

## 构成式语法的解析算法 CKY算法

> 给定定义好的CNF语法，对一句句子做自动语法分析

### 流程

- 给定一句输入句子
- 构建上三角表格
  - $T[i,j]$ 表示 $[i,j)$ 对应的短语可以标记成什么词性
- 按从左到右、从上到下的顺序填表
  - 在填写当前单元格时，需要用的子单元格已经填过
  - 可以动态规划

## 概率化的上下文无关语法 PCFG

$$ A \longrightarrow \beta [p] \Longrightarrow p = \mathbb{P}[\beta|A] $$

- $p$: 由节点 $A$ 分裂成节点集合 $\beta$ 的概率

### 给定语法

给定语法规则 $R$，计算句子 $V$ 与对应语法树 $T$ 的概率

$$ P(T,V) = P(S)P(S \rightarrow XX|S)P(XX\rightarrow \dots | XX) \cdot \cdots $$

- 根据语法及概率展开语法树计算条件概率
- 其中 $P(S) = 1$

$$ P(T,V) = P(T)P(V|T) $$

其中 $P(V|T)=1$，给定语法树的情况下，句子是确定的。故

$$ P(T,V) = P(T) $$

### 给定句子推断语法树

$$ \hat{T}(V) = \argmax_{y(T)=V} P(T|V) = \argmax_{y(T)=V} P(T) $$

### 概率化的语法解析 PCKY算法

- 基于CKY算法，在填表时同时计算最大的可能的概率
- 对语法规则 $A\longrightarrow B,C$
  - $C_{ij}(A) = C_{ik}(B) \cdot C_{kj}(C) \cdot P(A \longrightarrow B,C |A)$

## 评价指标

- 比较每个节点对应的句子中的词是否与真值一致
- 指标通常是 $F_\beta$
