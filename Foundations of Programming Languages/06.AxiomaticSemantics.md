# Axiomatic Semantics

## Intuition

### Logical Layout

We base a proof system on assertions of the form

$$ \{ A \}c\{ B \} $$

where $A$ and $B$ are assertions and $c$ is a command. 

The interpretation of this notation is: For all states $\sigma$ which satisfies $A$, if the execution of $c$ from state $\sigma$ terminates in state $\sigma'$ then $\sigma'$ satisfies $B$.

## Axiomatic Semantics

### Partial Correctness Assertion

Let $A,B$ be two logical formulas, $\sigma$ be a state satisfying $A$ ($\sigma \vDash A$), and $c$ be a command, a **partial correctness assertion** is of the form $\{A\}c\{B\}$, meaning

$$ \forall \sigma, \sigma' \in \Sigma.((\sigma \vDash A \land \langle c, \sigma \rangle \to \sigma') \Rightarrow \sigma' \vDash B) $$

- Assume $c$ starts execution with initial state $\sigma$ with $\sigma \vDash A$, if it terminates in $\sigma'$, then $\sigma' \vDash B$.
- It provides logical properties for input-output relationships.
- Partial correctness assertion does not consider cases if $c$ does not stop.
  - If $c$ does not stop, then any $\{A\}c\{B\}$ holds.

### Total Correctness Assertion

### Bottom Element

We introduce the bottom element $\bot$ to denote **non-termination**.

- $\mathcal{C}\llbracket c \rrbracket (\sigma) \coloneqq \bot$ if $c$ does not terminate on initial state $\sigma$.
- $\mathcal{C}\llbracket c \rrbracket(\bot) \coloneqq \bot$.
- $\bot \vDash A$ for all logical formulas $A$.

With the bottom element, partial correctness assertion is equivalent to

$$ \forall \sigma \in \Sigma.(\sigma \vDash A \Rightarrow \mathcal{C}\llbracket c \rrbracket(\sigma) \vDash B) $$

## An Assertion Language `Assn`

> TL;DR. First-order logic.

## Proof Rules for Partial Correctness Assertions

Manual validation of the validity $\vDash \{A\}c\{B\}$ is tedius. We want to establish some rules to make the proof easier.

### Hoare Rule

#### Skip

$$ \frac{}{\left\{ A \right\} \texttt{skip}\left\{ B \right\}} $$

#### Assignment

$$ \frac{}{\left\{ B[a/X] \right\} X \coloneqq a \left\{ B \right\}} $$

#### Sequential Composition

$$ \frac{\left\{ A \right\} c_0 \left\{ C \right\}, \quad \left\{ C \right\} c_1 \left\{ B \right\}}{\left\{ A \right\} c_0; c_1 \left\{ B \right\}} $$

#### Conditional Branch

$$ \frac{\left\{ A \land b \right\} c_0 \left\{ B \right\}, \qquad \left\{ A \land \neg b \right\} c_1 \left\{ B \right\}}{\left\{ A \right\} \texttt{if } b \texttt{ then } c_0 \texttt{ else } c_1 \left\{ B \right\}} $$

#### While Loop

$$ \frac{\left\{ A \land b \right\} c \left\{ A \right\}}{\left\{ A \right\} \texttt{while } a \texttt{ do } c \left\{ A \land \neg b \right\}} $$

- $A$ is called the **loop invariant**.

#### Consequence

$$ \frac{\vDash A \Rightarrow A', \quad \left\{ A' \right\}c\left\{ B' \right\}, \quad \vDash B' \Rightarrow B}{\left\{ A \right\} c \left\{ B \right\}} $$

### Proof System

- Proofs as derivation trees.
- Theorems as conclusion.
- Notion: $\vdash \left\{ A \right\} c \left\{ B \right\}$

## Soundness of Hoare Rules

- **Soundness.** $\vdash \left\{ A \right\} c \left\{ B \right\}$ implies $\vDash \left\{ A \right\} c \left\{ B \right\}$.
  - I.e., whatever we prove is valid.
- **Completeness.** $\vDash \left\{ A \right\} c \left\{ B \right\}$ implies $\vdash \left\{ A \right\} c \left\{ B \right\}$.
  - I.e., any valid formula is provable.

### Proof of Soundness
